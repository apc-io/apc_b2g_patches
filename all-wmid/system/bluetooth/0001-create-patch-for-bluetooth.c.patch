From bf5749fbb3b3c1394fb96a7c7c5692e39970a0db Mon Sep 17 00:00:00 2001
From: Phan Van Tuong <phanvan.tuong@nomovok.vn>
Date: Mon, 16 Dec 2013 17:45:02 +0700
Subject: [PATCH] create patch for bluetooth.c

---
 bluedroid/bluetooth.c |   14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/bluedroid/bluetooth.c b/bluedroid/bluetooth.c
index 4cc9204..2b4dc27 100644
--- a/bluedroid/bluetooth.c
+++ b/bluedroid/bluetooth.c
@@ -40,12 +40,14 @@
 
 #define MIN(x,y) (((x)<(y))?(x):(y))
 
+#define Bluetooth_use_rfkill 0
 
 static int rfkill_id = -1;
 static char *rfkill_state_path = NULL;
 
 
 static int init_rfkill() {
+#if Bluetooth_use_rfkill
     char path[64];
     char buf[16];
     int fd;
@@ -68,6 +70,10 @@ static int init_rfkill() {
 
     asprintf(&rfkill_state_path, "/sys/class/rfkill/rfkill%d/state", rfkill_id);
     return 0;
+#else
+    rfkill_id = 0;
+    return 0;
+#endif
 }
 
 static int check_bluetooth_power() {
@@ -76,6 +82,7 @@ static int check_bluetooth_power() {
     int ret = -1;
     char buffer;
 
+#if Bluetooth_use_rfkill
     if (rfkill_id == -1) {
         if (init_rfkill()) goto out;
     }
@@ -105,12 +112,16 @@ static int check_bluetooth_power() {
 out:
     if (fd >= 0) close(fd);
     return ret;
+#else
+    return 1;
+#endif
 }
 
 static int set_bluetooth_power(int on) {
     int sz;
     int fd = -1;
     int ret = -1;
+#if Bluetooth_use_rfkill
     const char buffer = (on ? '1' : '0');
 
     if (rfkill_id == -1) {
@@ -134,6 +145,9 @@ static int set_bluetooth_power(int on) {
 out:
     if (fd >= 0) close(fd);
     return ret;
+#else
+    return 0;
+#endif
 }
 
 static inline int create_hci_sock() {
-- 
1.7.9.5

